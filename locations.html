<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>Brown Bag Lunch France - Locations</title>

        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/foundation/4.2.3/css/foundation.css" media="screen">
        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/foundation/4.2.3/css/normalize.css" media="screen">

        <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css"/>

        <!--[if IE 8]>
        <link rel="stylesheet" href="css/foundation-IE8Support.css" media="screen">
        <![endif]-->
        
        <style type="text/css">
            /* Seems a bug in foundation 4 : */
            .panel.callout a{
                color:#fff;
            }                       
            .panel.callout li {
                color:#fff;
            }
        </style>

        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.7.0/mustache.min.js"></script>

        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-38399904-1']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </head>

    <body>

        <div class="sticky">
          <nav class="top-bar" data-topbar>
            <ul class="title-area">
              <li class="name">
                <h1><a href="index.html">Brown Bag Lunch France</a></h1>
              </li>
            </ul>

            <section class="top-bar-section">
              <!-- Right Nav Section -->
              <ul class="right">
                <li><a href="baggers.html"><i class="icon-search"></i> Trouver un bagger</a></li>
                <li class="divider"></li>
                <li class="has-dropdown">
                  <a href="#">BBL Hôtes</a>
                  <ul class="dropdown" id="bblNavigationBar">
                    {{#locations}}
                        <li><a href="#{{pseudo}}">{{name}}</a></li>
                    {{/locations}}
                  </ul>
                </li>
              </ul>

              <!-- Left Nav Section -->
              <ul class="left">
                <li class="divider"></li>
                <li><a href="index.html"><i class="icon-lightbulb"></i> Comment ça fonctionne?</a></li>
              </ul>
            </section>
          </nav>
        </div>
  
        <!-- LOCATIONS! -->
        <script type="text/javascript" src="js/bbl-locations.js"></script>

    <!-- Image header -->
    <!--<div class="row">-->
        <!--<div class="twelve columns">-->
            <!--<img width="910" height="364" src="img/BBL.jpg">-->
            <!--<hr>-->
        <!--</div>-->
    <!--</div>-->

    <!-- Carte des BBL -->
    <div class="row">
        <div class="panel radius">
            <div id="map_canvas" style="height: 500px;"></div>
        </div>
    </div>

    <!-- BBL Hotes -->
    <div id="bblDetails">
        {{#locations}}
            <a id="{{pseudo}}"></a>
            <div id="{{pseudo}}_box" class="row">
                {{^paire}}
                    <div class="small-2 large-4 columns">
                        <img src="{{picture}}">
                    </div>
                {{/paire}}
                <div class="small-10 large-8 columns">
                    <div class="panel {{#paire}}callout{{/paire}} radius">
                        <h4>{{name}}</h4>

                        <div class="row">

                            <div class="small-6 large-6 columns">
                                <p>{{{bio}}}</p>
                                <p><a href="{{website}}"><i class="icon-external-link"></i> {{website}}</a></p>
                                <p><i class="icon-globe"></i> Localisation: {{address}}</p>
                                <p><i class="icon-envelope"></i> Infos et contact : {{{contact}}}</p>
                            </div>

                            <div class="small-6 large-6 columns">
                                <span class="{{#paire}}secondary{{/paire}} round label">Centres d'intérêts</span>
                                <ul class="icons">
                                    {{#interests}}
                                        <li><i class="icon-caret-right"></i> <strong>{{.}}</strong></li>
                                    {{/interests}}
                                </ul>
                                <span class="{{#paire}}secondary{{/paire}} round label">Audience</span>
                                <ul class="icons">
                                    <li><i class="icon-sitemap"></i> {{audience.profiles}}</li>
                                    <li><i class="icon-group"></i> {{audience.number}}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                {{#paire}}
                    <div class="small-2 large-4 columns">
                        <img src="{{picture}}">
                    </div>
                {{/paire}}
            </div>
        {{/locations}}
    </div>

    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://jquery-ui-map.googlecode.com/svn/trunk/ui/jquery.ui.map.js"></script>

    <script type="text/javascript">
        $('#map_canvas').gmap({'callback': function() {
            var self = this; // we can't use "this" inside the click function (that refers to the marker object in this example)
            for (var index = 0; index < bblLocationsData.locations.length; index++) {
                var loc = bblLocationsData.locations[index];
                self.addMarker({
                    'position': loc.gps,
                    'name': loc.name,
                    'pseudo': loc.pseudo,
                    'bounds': true
                }).click(function() {
                    self.openInfoWindow({
                        'content': '<a href="#' + this.pseudo + '">' + this.name + '</a>'
                    }, this);
                });
            }
        }});
    </script>

        <footer style="width:100%;background:#3f3f3f; color:white; padding: 15px 0">
          <div class="row">
            <strong>
              Vous voulez proposer vous aussi des sujets ? Rejoignez la communauté des baggers :
              <a style="color: yellow;" href="https://github.com/nrichand/BrownBagLunch/"><i class="icon-github-alt"></i> page github</a>
                       | <a style="color: yellow;" href="https://twitter.com/bbl_fr"><i class="icon-twitter"></i> @bbl_fr</a>
            </strong>
          </div>
        </footer>

        <!-- Included JS Files -->
        <script src="http://cdnjs.cloudflare.com/ajax/libs/foundation/4.2.3/js/foundation.min.js"></script>
        
        <script>
            $(document).foundation();
        </script>

        <script type="text/javascript">
            // decorate data
            for (var locationIndex = 0; locationIndex < bblLocationsData['locations'].length; locationIndex++) {
                bblLocationsData['locations'][locationIndex]['paire'] = (locationIndex % 2 == 1);
            }

            //get the templates
            var templateHeader=document.getElementById('bblNavigationBar').innerHTML;
            var templateBaggers=document.getElementById('bblDetails').innerHTML;

            //render the template with given data
            var htmlHeader=Mustache.to_html(templateHeader, bblLocationsData);
            var htmlDetails=Mustache.to_html(templateBaggers, bblLocationsData);

            //put the render result on the screen
            document.getElementById('bblNavigationBar').innerHTML=htmlHeader;
            document.getElementById('bblDetails').innerHTML=htmlDetails;

        </script>

    </body>
</html>
